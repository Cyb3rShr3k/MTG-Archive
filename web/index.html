<!DOCTYPE HTML>
<html>
<head>
	<title>MTG Archive - Dashboard</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="HTML5up/assets/css/main.css" />
	<script src="api.js"></script>
	<script src="shared-nav.js"></script>
	<style>
		.stat-card {
			background: linear-gradient(135deg, rgba(245, 106, 106, 0.1) 0%, rgba(76, 132, 255, 0.1) 100%);
			padding: 2em;
			border-radius: 4px;
			text-align: center;
			border-left: 4px solid #f56a6a;
			transition: all 0.3s ease;
		}
		.stat-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 30px rgba(0,0,0,0.2);
		}
		.stat-card h3 {
			margin: 0 0 0.5em 0;
			color: #f56a6a;
			font-size: 3em;
			font-weight: bold;
		}
		.stat-card p {
			margin: 0;
			color: #999;
			text-transform: uppercase;
			font-size: 0.8em;
			letter-spacing: 0.25em;
		}
		.quick-action-card {
			transition: all 0.3s ease;
			cursor: pointer;
		}
		.quick-action-card:hover {
			transform: translateY(-3px);
		}
	</style>
</head>
<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">

				<!-- Header (injected by shared-nav.js) -->
				<script>document.write(sharedNav.header('Dashboard'));</script>

				<!-- Banner -->
				<section id="banner">
					<div class="content">
						<header>
							<h1>Welcome to<br />MTG Archive</h1>
							<p>Your Personal Card Collection Manager</p>
						</header>
						<p>Organize your Magic: The Gathering collection with ease. Import cards via CSV or OCR, build custom decks, browse your collection with advanced filters, and track your collection's growth. Whether you're a casual player or serious collector, MTG Archive has the tools you need.</p>
						<ul class="actions">
							<li><a href="card_addition.html" class="button big primary icon solid fa-plus">Add Cards</a></li>
							<li><a href="deckbuilding.html" class="button big icon solid fa-layer-group">Build Decks</a></li>
						</ul>
					</div>
					<span class="image object">
						<img src="assets/MTG-Archive.png" alt="MTG Archive" style="border-radius:8px;" />
					</span>
				</section>

				<!-- Stats -->
				<section>
					<header class="major">
						<h2>Collection Overview</h2>
					</header>
					<div class="row gtr-200">
						<div class="col-4 col-12-medium">
							<div class="stat-card">
								<h3 id="totalCards">0</h3>
								<p>Total Cards</p>
							</div>
						</div>
						<div class="col-4 col-12-medium">
							<div class="stat-card" style="border-left-color: #4c84ff;">
								<h3 id="uniqueCards">0</h3>
								<p>Unique Cards</p>
							</div>
						</div>
						<div class="col-4 col-12-medium">
							<div class="stat-card" style="border-left-color: #39c088;">
								<h3 id="totalDecks">0</h3>
								<p>Decks Built</p>
							</div>
						</div>
					</div>
				</section>

				<!-- Quick Actions -->
				<section>
					<header class="major">
						<h2>Quick Actions</h2>
					</header>
					<div class="features">
						<article class="quick-action-card" onclick="window.location.href='card_addition.html'">
							<span class="icon solid fa-plus"></span>
							<div class="content">
								<h3>Add Cards</h3>
								<p>Manually add cards to your collection or import them via CSV.</p>
							</div>
						</article>
						<article class="quick-action-card" onclick="window.location.href='card_addition.html#scan'">
							<span class="icon solid fa-camera"></span>
							<div class="content">
								<h3>Scan Cards</h3>
								<p>Use OCR technology to scan and identify cards from images.</p>
							</div>
						</article>
						<article class="quick-action-card" onclick="window.location.href='deckbuilding.html'">
							<span class="icon solid fa-layer-group"></span>
							<div class="content">
								<h3>Build Decks</h3>
							<p>Create custom decks from your collection with drag-and-drop.</p>
							</div>
						</article>
						<article class="quick-action-card" onclick="window.location.href='deckbuilding.html#precon'">
							<span class="icon solid fa-download"></span>
							<div class="content">
								<h3>Import Precon</h3>
								<p>Import complete preconstructed decks from our database.</p>
							</div>
						</article>
						<article class="quick-action-card" onclick="window.location.href='deckbuilding.html#search'">
							<span class="icon solid fa-search"></span>
							<div class="content">
								<h3>Browse Collection</h3>
								<p>Search and filter your entire card collection.</p>
							</div>
						</article>
						<article class="quick-action-card" onclick="window.location.href='card_addition.html#csv'">
							<span class="icon solid fa-file-csv"></span>
							<div class="content">
								<h3>CSV Import</h3>
								<p>Bulk import cards from a CSV file with Scryfall IDs.</p>
							</div>
						</article>
					</div>
				</section>

				<!-- Recent Decks -->
				<section id="recentDecks" style="display:none;">
					<header class="major">
						<h2>Recent Decks</h2>
					</header>
					<div id="decksList" class="posts"></div>
				</section>

			</div>
		</div>

		<!-- Sidebar (injected by shared-nav.js) -->
		<script>document.write(sharedNav.sidebar);</script>

	</div>

	<!-- Scripts -->
	<script src="HTML5up/assets/js/jquery.min.js"></script>
	<script src="HTML5up/assets/js/browser.min.js"></script>
	<script src="HTML5up/assets/js/breakpoints.min.js"></script>
	<script src="HTML5up/assets/js/util.js"></script>
	<script src="HTML5up/assets/js/main.js"></script>

	<script>
		// Load dashboard data
		async function loadDashboard() {
			try {
				// Load stats
				const total = await window.pywebview.api.get_collection_count();
				document.getElementById('totalCards').textContent = total || 0;

				const decks = await window.pywebview.api.list_decks();
				document.getElementById('totalDecks').textContent = Array.isArray(decks) ? decks.length : 0;

				const collection = await window.pywebview.api.search_collection({ query: '', filters: {} });
				const uniqueNames = new Set();
				if (Array.isArray(collection)) {
					collection.forEach(card => uniqueNames.add(card.name));
				}
				document.getElementById('uniqueCards').textContent = uniqueNames.size;

				// Load recent decks
				if (Array.isArray(decks) && decks.length > 0) {
					const recentSection = document.getElementById('recentDecks');
					const decksList = document.getElementById('decksList');
					recentSection.style.display = 'block';

					const html = decks.slice(0, 6).map(deck => `
						<article>
							<a href="deckbuilding.html#view-deck" class="image" style="background:#333; display:flex; align-items:center; justify-content:center; color:#999;">
								<span class="icon solid fa-layer-group" style="font-size:3em;"></span>
							</a>
							<h3>${deck.name || 'Unnamed Deck'}</h3>
							<p>${deck.deck_type || 'Standard'} • ${deck.card_count || 0} cards${deck.commander ? ` • ${deck.commander}` : ''}</p>
							<ul class="actions">
								<li><a href="deckbuilding.html#edit-${deck.name}" class="button small">View Deck</a></li>
							</ul>
						</article>
					`).join('');

					decksList.innerHTML = html;
				}
			} catch (error) {
				console.error('Dashboard load error:', error);
			}
		}

		// Initialize on load
		window.addEventListener('DOMContentLoaded', loadDashboard);
	</script>

</body>
</html>
